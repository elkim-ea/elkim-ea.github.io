---
layout: post
title: " 2. ReplicaSets"
date: 2026-01-25
categories:
  - "Certification/CKA"  
---

#### Reference
- [Udemy – Certified Kubernetes Administrator (CKA) with Practice Tests](https://www.udemy.com/course/certified-kubernetes-administrator-with-practice-tests/?couponCode=KEEPLEARNING)
(https://uklabs.kodekloud.com/topic/practice-test-replicasets-2/)

---

```bash
kubectl get replicaset

kubectl describe replicaset new-replica-set

kubectl describe pod new-replica-set-kc64p
```

### Create a ReplicaSet using the replicaset-definition-1.yaml file located at /root/.

```bash
ls /root

kubectl create -f /root/replicaset-definition-1.yaml 
```

애러가 난다 replicaset은 v1이 아니기 때문 그러므로 수정을 해줘야한다 구체적으로 알기위해서는

```bash
kubectl explain replicaset
```

하면은 GROUP가 apps로 되어 있다 그러므로 **apiVersion을 apps/v1 으로 수정해줘야한다**

```bash
vi /root/replicaset-definition-1.yaml

kubectl create -f /root/replicaset-definition-1.yaml
```

### Fix the issue in the replicaset-definition-2.yaml file and create a ReplicaSet using it.This file is located at /root/.

```bash
ls

kubectl create -f replicaset-definition-2.yaml
```

***The ReplicaSet "replicaset-2" is invalid: spec.template.metadata.labels: Invalid value: {"tier":"nginx"}: `selector` does not match template `labels`*** 라고 오류뜸
이 말은 selector의 tier과 labels의 tier이 일치하지 않다는 의미 그래서 둘 중하나로 동일하게 해주면 된다

``` bash
vi replicaset-definition-2.yaml
```

```yaml
apiVersion: apps/v1
kind: ReplicaSet
metadata:
  name: replicaset-2
spec:
  replicas: 2
  selector:
    matchLabels:
      tier: frontend 를 nginx로 수정*******
  template:
    metadata:
      labels:
        tier: nginx
    spec:
      containers:
      - name: nginx
        image: nginx
```

```bash
kubectl create -f replicaset-definition-2.yaml
```

### Delete the two newly created ReplicaSets - replicaset-1 and replicaset-2

```bash
kubectl get rs

kubectl delete rs replicaset-1

kubectl delete rs replicaset-2
```

### Fix the original replica set new-replica-set to use the correct busybox image.
### Either delete and recreate the ReplicaSet or update the existing ReplicaSet and then delete all PODs, so new ones with the correct image will be created.
### If you opt to delete the ReplicaSet and recreate it, please refer to the file named new-replica-set.yaml, which is saved in the /root/ directory for your convenience and fix it.

```bash
kubectl get rs

kubectl edit rs new-replica-set
```

```yaml
apiVersion: apps/v1
kind: ReplicaSet
metadata:
  creationTimestamp: "2026-01-24T18:00:32Z"
  generation: 1
  name: new-replica-set
  namespace: default
  resourceVersion: "1416"
  uid: da46ec19-3a81-43a3-a7dd-7f2049f4d6c7
spec:
  replicas: 4
  selector:
    matchLabels:
      name: busybox-pod
  template:
    metadata:
      labels:
        name: busybox-pod
    spec:
      containers:
      - command:
        - sh
        - -c
        - echo Hello Kubernetes! && sleep 3600
        image: busybox777를 busybox로 수정 ********
        imagePullPolicy: Always
        name: busybox-container
        resources: {}
```

```bash
kubectl get pods

kubectl get rs
```

수정해도 업데이트가 안됨 그래서 파드를 모두 삭제하고 만들어야한다

```bash
kubectl delete pod new-replica-set-j86pw new-replica-set-kc64p new-replica-set-sfd9f new-replica-set-wt2hl

kubectl get pods

kubectl get rs
```

그리고 다시확인하기

### Scale the ReplicaSet to 5 PODs.
### Use kubectl scale command or edit the replicaset using kubectl edit replicaset.

```bash
kubectl scale rs new-replica-set --replicas=5

kubectl get pods

kubectl edit rs new-replica-set
```

### Now scale the ReplicaSet down to 2 PODs.
### Use the kubectl scale command or edit the replicaset using kubectl edit replicaset.

```bash
kubectl edit rs new-replica-set
```

```yaml
apiVersion: apps/v1
kind: ReplicaSet
metadata:
  creationTimestamp: "2026-01-24T18:00:32Z"
  generation: 3
  name: new-replica-set
  namespace: default
  resourceVersion: "2379"
  uid: da46ec19-3a81-43a3-a7dd-7f2049f4d6c7
spec:
  replicas: 5를2로 바꾼다 ***** 
  selector:
    matchLabels:
      name: busybox-pod
  template:
    metadata:
      labels:
        name: busybox-pod
    spec:
      containers:
      - command:
        - sh
        - -c
        - echo Hello Kubernetes! && sleep 3600
        image: busybox
        imagePullPolicy: Always
        name: busybox-container
        resources: {}
```


---







