---
layout: post
title: " 7.AWS(SAA) - Route 53 (Eng.ver) "
date: 2026-01-17
categories:
  - "Certification/AWS SAA"
---

#### Reference
- [Udemy – AWS Certified Solutions Architect Associate (SAA-C03)](https://www.udemy.com/course/aws-certified-solutions-architect-associate-saa-c03/?couponCode=CP251120G2)

# 1. What's is a DNS?
## What is DNS?
- Domain Name System which translates the human friendly hostnames into the machine IP addresses
- www.google.com => 172.217.18.36
- DNS is the backbone of the Internet
- DNS uses hierarchical naming structure

``` text
.com
example.com
www.example.com
api.example.com
```

## DNS Terminologies
- Domain Registrar : Amazon Route 53, GoDaddy,...
- DNS Records : A, AAAA, CNAME, NS,...
- Zone File : contains DNS records
- Name Server : resolves DNS queries (Authoritative or Non-Authoritative)
- Top Level Domain (TLD) : .com, .us, .in, .gov, .org, ...
- Second Level Domain (SLD) : amazon.com, google.com

<img src="{{ '/assets/img/images/aws/DNS Terminologies.png' | relative_url }}" alt="스크린샷" width="300">

## How DNS Works

<img src="{{ '/assets/img/images/aws/How DNS Works.png' | relative_url }}" alt="스크린샷" width="300">

# 2. Route 53 Overview
## Amazon Route 53
- A highly available, scalable, fully managed and Authoritative DNS
  - Authoritative = the customer (you) can update the DNS records
- Route 53 is also a Domain Registrar
- Ability to check the health of your resources
- The only AWS service which provides 100% availability SLA
- Why Route 53? 53 is a reference to the traditional DNS port

<img src="{{ '/assets/img/images/aws/Amazon Route 53.png' | relative_url }}" alt="스크린샷" width="300">

## Route 53 - Records
- How you want to route traffic for a domain
- Each record contains :
  - Domain / subdomain Name - e.g., example.com
  - Record Type - e.g., A or AAAA
  - Value - e.g., 12.23.56.78
  - Routing Policy - how Route 53 responds to queries
  - TTL - amount of time the record cached at DNS Resolvers
- Route 53 supports the following DNS record types :
  - (must know) A / AAAA / CNAME / NS
  - (advanced) CAA / DS / MX / NAPTR / PTR / SOA / TXT / SPF / SRV

## Route 53 - Record Types
- A - maps a hostname to IPv4
- AAAA - maps a hostname to IPv6
- CNAME - maps a hostname to another hostname
  - The target is a domain name which must have an A or AAAA record
  - Can't create CNAME record for the top node of a DNS namespace (Zone Apex)
  - Example : you can't create for example.com, but you can create for www.example.com
- NS -Name Servers for the Hosted Zone
  - Control how traffic is routed for a domain

## Route 53 - Hosted Zones
- A container for records that define how to route traffic to a domain and its subdomains
- Public Hosted Zones - contains records that specify how to route traffic on the Internet (public domain names)            
application1.mypublicdomain.com
- Private Hosted Zones - contain records that specify how you route traffic within one or more VPCs (private domain names)           
application1.company.internal
- You pay $0.50 per month per hosted zone

## Route 53 - Public vs. Private Hosted Zones

<img src="{{ '/assets/img/images/aws/Public vs. Private Hosted Zones.png' | relative_url }}" alt="스크린샷" width="300">

# 3. Route 53 - TTL
## Route 53 - TTL (Time to Live)
- High TTL - e.g., 24hr
  - Less traffic on Route 53
  - Possibly outdated records
- Low TTL -e.g., 60 sec.
  - More traffic on Route 53 (cost)
  - Records are outdated for less time
  - Easy to change records
- Except for Alias records, TTL is mandatory for each DNS record

<img src="{{ '/assets/img/images/aws/Route 53 - TTL (Time to Live).png' | relative_url }}" alt="스크린샷" width="300">

# 4. Route 53 CNAME vs Alias
## CNAME vs Alias
- AWS Resources (Load Balancer, CloudFront,...) expose an AWS hostname :
  - ib-1234.us-east-2.elb.amazonaws.com and you want myapp.mydomain.com
- CNAME : 
  - Points a hostname to any other hostname (app.mydomain.com => blabla.anything.com)
  - ONLY FOR YOU NON ROOT DOMAIN (aka.something.mydomain.com)
- Alias :
  - Points a hostname to an AWS Resource (app.mydomain.com => blabla.amazonaws.com)
  - Works for ROOT DOMAIN and NON ROOT DOMAIN (aka.mydomain.com)
  - Free of charge
  - Native health check

  ## Route 53 - Alias Records
  - Maps a hostname to an AWS resource
  - An extention to DNS functionality
  - Automatically recognizes changes in the resource's IP addresses
  - Unlike CNAME, it can be used for the top node of a DNS namespace (Zone Apex), e.g. : example.com
  - Alias Record is always of type A/AAAA for AWS resources (IPv4 / IPv6)
  - You can't set the TTL 

<img src="{{ '/assets/img/images/aws/Route 53 - Alias Records.png' | relative_url }}" alt="스크린샷" width="300">

  ## Route 53 - Alias Records Targets
  - Elastic Load Balancers
  - CloudFront Distributions
  - API Gateway
  - Elastic Beanstalk environments
  - S3 Websites
  - VPC Interface Endpoints
  - Global Accelerator accelerator
  - Route 53 record in the same hosted zone
  - You cannot set an ALIAS record for an EC2 DNS name

<img src="{{ '/assets/img/images/aws/Route 53 - Alias Records Targets.png' | relative_url }}" alt="스크린샷" width="300">

# 5. Routing Policy - Simple
## Route 53 - Routing Policies
- Define how Route 53 responds to DNS queries
- Don't get confused by the word "Routing"
  - It's not the same as Load Balancer routing which routes the traffic
  - DNS does not route any traffic, it only responds to the DNS queries
- Route 53 Supports the following Routing Policies
  - Simple
  - Weighed
  - Failover
  - Latency based
  - Geolocation
  - Multi-Value Answer
  - Geoproximity (using Route 53 Traffic Flow feature)

  ## Routing Policies - Simple
  - Typically, route traffic to a single resource
  - Can specify multiple values in the same record
  - If multiple values are returned, a random one is chosen by the client
  - When Alias enabled, specify only one AWS resource
  - Can't be associated with Health Checks

<img src="{{ '/assets/img/images/aws/Routing Policies - Simple.png' | relative_url }}" alt="스크린샷" width="300">

# 6. Routing Policy - Weighted
## Routing Policies - Weighted
- Control the % of the requests that go to each specific resource
- Assign each record a relative weight : 

  - \[
\text{traffic (\%)} =
\frac{\text{Weight for a specific record}}
{\text{Sum of all the weights for all records}}
\]

  - Weights don't need to sum up to 100
- DNS records must have the same name and type
- Can be associated with Health Checks
- Use cases : load balancing between regions, testing new application versions...
- Assign a weight of 0 to a record to stop sending traffic to a resource
- If all records have weight of 0, then all records will be returned equally

<img src="{{ '/assets/img/images/aws/Routing Policies - Weighted.png' | relative_url }}" alt="스크린샷" width="300">

# 7. Routing Policy - Latency
## Routing Policies - Latwncy-based
- Redirect to the resources that has the least latency close to us
- Super helpful when latency for users is a priority
- Latency is based on traffic between users and AWS Regions
- Germany users may be directed to the US (if that's the lowest latency)
- Can be associated with Health Checks (has a failover capability)

<img src="{{ '/assets/img/images/aws/Routing Policy - Latency.png' | relative_url }}" alt="스크린샷" width="300">

# 8. Routing 53 - Health Checks
## Routing 53 - Health Checks
- HTTP Health Checks are only for public resources
- Health Check => Automated DNS Failover : 
  1. Health Checks that monitor an endpoint (application, server, other AWS resource)
  2. Health Checks that monitor other health checks (Calculated Hralth Checks)
  3. Health Checks that monitor CloudWatch Alarms (full control) -e.g., throttles of DynamoDB, alarms on RDS, custom metrics, ... (helpful for private resources)
- Health Checks are integrated with CW metrics

<img src="{{ '/assets/img/images/aws/Routing 53 - Health Checks.png' | relative_url }}" alt="스크린샷" width="300">

## Health Checks - Monitor an Endpoint
- About 15 global health checkers will check the endpoint health
  - Healthy / Unhealthy Threshold - 3 (default)
  - Interval - 30 sec (can set to 10 sec - higher cost)
  - Supported protocol : HTTP, HTTPS and TCP
  - If > 18% of health checkers report the endpoint is healthy, Route 53 considers it Healthy. Otherwise, it's Unhealthy
  - Ability to choose which locations you want Route 53 to use
- Health Checks pass only when the endpoint responds with the 2xx and 3xx status codes
- Heallth Checks can be setup to pass / fail based on the text in the first 5120 bytes of the response
- Configure you router / firewall to allow incoming requests from Route 53 Health Checkers

<img src="{{ '/assets/img/images/aws/Health Checks - Monitor an Endpoint.png' | relative_url }}" alt="스크린샷" width="300">

## Route 53 - Calculated Health Checks
- Combine the results of multiple Health Checks into a single Health Check
- You can OR, AND, or NOT
- Can monitor up to 256 Child Health Checks
- Specify how many of the health checks need to pass to make the parent pass
- Usage : perform maintenance to your website without causing all health checks to fail

<img src="{{ '/assets/img/images/aws/Route 53 - Calculated Health Checks.png' | relative_url }}" alt="스크린샷" width="300">

## Health Checks - Private Hosted Zones
- Route 53 health checkers are outside the VPC
- They can't access private endpoint (private VPC or on-premises resource)
- You can create a CloudWatch Metric and associate a CloudWatch Alarm, then create a Health Check that checks the alarm itself

<img src="{{ '/assets/img/images/aws/Health Checks - Private Hosted Zones.png' | relative_url }}" alt="스크린샷" width="300">

# 9. Routing Policy - Failover
## Routing Policies - Failover (Active-Passive)

<img src="{{ '/assets/img/images/aws/Routing Policies - Failover (Active-Passive).png' | relative_url }}" alt="스크린샷" width="300">

# 10. Routing Policy - Geolocation
## Routing Policies - Geolocation
- Different from Latency-based
- This routing is based on user location
- Specify location by Continent, Country or by US State (if there's overlapping, most precise location selected)
- Should create a "Default" record (in case there's no match on location)
- Use cases : website localization, restrict content distribution, load balancing,...
- Can be associated with Health Checks

<img src="{{ '/assets/img/images/aws/Routing Policies - Geolocation.png' | relative_url }}" alt="스크린샷" width="300">

# 11. Routing Policy - Geoproximity
## Geoproximity Routing Policy
- Route traffic to your resources based on the geographic location of users and resources
- Ability to shift more traffic to resources based on the defined bias
- To change the size of the geographic region, specify bias values :
  - To expend (1 to 99) - more traffic to the resource
  - To shrink (-1 to 99) - less traffic to the resource
- Resources can be :
  - AWS resources (specify AWS region)
  - Non-AWS resources (specify Latitude and Longitude)
- You must use Route 53 Traffic Flow (advanced) to use this feature

## Geoproximity Routing Policy

<img src="{{ '/assets/img/images/aws/Geoproximity Routing Policy.png' | relative_url }}" alt="스크린샷" width="300">

## Geoproximity Routing Policy Higher bias in us-east-1

<img src="{{ '/assets/img/images/aws/Geoproximity Routing Policy Higher bias in us-east-1.png' | relative_url }}" alt="스크린샷" width="300">

# 12. Route Policy - IP - based
## Route Policy - IP - based Routing
- Routing is based on clients'IP addresses
- You provide a list of CIDRs for your clients and the corresponding endpoints / locations (user-IP-to_endpoint mappings)
- Use cases : Optimize performance, reduce network costs...
- Example : route end users from a particular ISP to a specific endpoint

<img src="{{ '/assets/img/images/aws/Route Policy - IP - based Routing.png' | relative_url }}" alt="스크린샷" width="300">

# 12. Route Policy - Multi Value
## Routing Policies - Multi - Value
- Use when routing traffic to multiple resources
- Route 53 return multiple values / resources
- Can be associated with Health checks (return only values for healthy resources)
- Up to 8 healthy records are returned for each Multi - Value query
- Multi - Value is not a substitute for having an ELB

<img src="{{ '/assets/img/images/aws/Routing Policies - Multi - Value.png' | relative_url }}" alt="스크린샷" width="300">

# 13. 3rd Party Domains & Route 53
## Domain Registar vs. DNS Service
- You buy or register your domain name with a Domain Registrar typically by paying annual charges (e.g., GoDaddy, Amazon Registrar Inc., ...)
- The Domain Registrar usually provides you with a DNS services to manage your DNS records
- But you can use another DNS service to manage your DNS records
- Example : purchase the domain from GoDaddy and use Route 53 to manage your DNS records

<img src="{{ '/assets/img/images/aws/Domain Registar vs. DNS Service.png' | relative_url }}" alt="스크린샷" width="300">

# 14. Route 53 Resolvers & Hybrid DNS
## Route 53 - Hybrid DNS
- By default, Route 53 Resolver automatically answers DNS queries for :
  - Local domain names for EC2 instances
  - Records in Private Hosted Zones
  - Records in public Name Servers
- Hybrid DNS - resolving DNS queries between VPC (Route 53 Resolver) and your networks (other DNS Resolvers)
- Networks can be : 
  - VPC itself / Peered VPC
  - On-premises Network (connected through Direct Connect or AWS VPN)

<img src="{{ '/assets/img/images/aws/Route 53 - Hybrid DNS.png' | relative_url }}" alt="스크린샷" width="300">

##  Route 53 - Resolver Endpoints
- Inbound Endpoint 
  - allows your DNS Resolvers to resolve domain names for AWS resources (e.g., EC2 instances) and records in Private Hosted Zones

<img src="{{ '/assets/img/images/aws/Route 53 - Resolver Endpoints.png' | relative_url }}" alt="스크린샷" width="300">

- Outbound Endpoint
  - Route 53 Resolver forwards DNS queries to your DNS Resolvers

<img src="{{ '/assets/img/images/aws/Route 53 - Resolver Endpoints1.png' | relative_url }}" alt="스크린샷" width="300">
